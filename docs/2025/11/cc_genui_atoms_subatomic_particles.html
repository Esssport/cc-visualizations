<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Quantum World: Atoms and Subatomic Particles</title>
  <meta name="description" content="Educational visualization exploring atoms, subatomic particles, quarks, and quantum mechanics">

  <style>
    /* Academic Theme - Dark Mode */
    :root {
      --bg-primary: #1a1611;
      --bg-secondary: #252019;
      --text-primary: #e8e4dc;
      --text-secondary: #b8b0a5;
      --accent-blue: #6ba4e7;
      --accent-orange: #f4a940;
      --success-green: #4db86d;
      --border-color: #3a3228;

      --font-primary: 'Crimson Pro', 'Crimson Text', Georgia, serif;
      --font-secondary: 'Inter Display', -apple-system, system-ui, sans-serif;
      --font-mono: 'Source Code Pro', 'Courier New', monospace;
    }

    /* Reset & Base */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: var(--font-primary);
      font-size: clamp(1rem, 1.5vw, 1.125rem);
      line-height: 1.8;
      color: var(--text-primary);
      background: var(--bg-primary);
      overflow-x: hidden;
    }

    /* Layout */
    .educational-container {
      display: flex;
      min-height: 100vh;
    }

    .glossary-sidebar {
      position: sticky;
      top: 0;
      width: 300px;
      height: 100vh;
      overflow-y: auto;
      background: var(--bg-secondary);
      border-right: 1px solid var(--border-color);
      padding: 2rem 1.5rem;
      flex-shrink: 0;
    }

    .content-area {
      flex: 1;
      max-width: 900px;
      margin: 0 auto;
      padding: 3rem 2rem;
    }

    /* Sidebar Styles */
    .sidebar-header {
      margin-bottom: 1.5rem;
    }

    .sidebar-title {
      font-family: var(--font-secondary);
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--accent-blue);
      margin-bottom: 1rem;
    }

    .glossary-search {
      width: 100%;
      padding: 0.75rem 1rem;
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      border-radius: 6px;
      color: var(--text-primary);
      font-family: var(--font-secondary);
      font-size: 0.95rem;
      margin-bottom: 1rem;
    }

    .glossary-search:focus {
      outline: 2px solid var(--accent-blue);
      outline-offset: 2px;
    }

    .glossary-filters {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 1.5rem;
      flex-wrap: wrap;
    }

    .filter-btn {
      padding: 0.5rem 0.875rem;
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      border-radius: 4px;
      color: var(--text-secondary);
      font-family: var(--font-secondary);
      font-size: 0.8rem;
      cursor: pointer;
      transition: all 0.2s;
    }

    .filter-btn.active {
      background: var(--accent-blue);
      color: #fff;
      border-color: var(--accent-blue);
    }

    .glossary-list {
      list-style: none;
    }

    .glossary-item {
      margin-bottom: 0.5rem;
    }

    .glossary-link {
      display: block;
      padding: 0.75rem 1rem;
      background: none;
      border: none;
      border-left: 3px solid transparent;
      color: var(--text-primary);
      font-family: var(--font-primary);
      font-size: 0.95rem;
      text-align: left;
      cursor: pointer;
      width: 100%;
      transition: all 0.2s;
    }

    .glossary-link:hover,
    .glossary-link:focus {
      background: var(--bg-primary);
      border-left-color: var(--accent-blue);
      color: var(--accent-blue);
    }

    .importance-badge {
      display: inline-block;
      padding: 0.125rem 0.5rem;
      background: var(--accent-orange);
      color: var(--bg-primary);
      font-size: 0.7rem;
      font-weight: 600;
      border-radius: 3px;
      margin-left: 0.5rem;
    }

    /* Typography */
    h1 {
      font-family: var(--font-secondary);
      font-size: clamp(2.25rem, 4vw, 3.5rem);
      font-weight: 900;
      line-height: 1.1;
      color: var(--accent-blue);
      margin-bottom: 1.5rem;
    }

    h2 {
      font-family: var(--font-secondary);
      font-size: clamp(1.75rem, 3vw, 2.5rem);
      font-weight: 700;
      color: var(--text-primary);
      margin: 3rem 0 1.5rem;
      border-bottom: 2px solid var(--border-color);
      padding-bottom: 0.5rem;
    }

    h3 {
      font-family: var(--font-secondary);
      font-size: clamp(1.35rem, 2vw, 1.85rem);
      font-weight: 700;
      color: var(--text-primary);
      margin: 2rem 0 1rem;
    }

    h4 {
      font-family: var(--font-secondary);
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--accent-orange);
      margin: 1.5rem 0 0.75rem;
    }

    p {
      margin-bottom: 1.5rem;
    }

    strong {
      color: var(--accent-orange);
      font-weight: 700;
    }

    code {
      font-family: var(--font-mono);
      font-size: 0.9em;
      background: var(--bg-secondary);
      padding: 0.2rem 0.4rem;
      border-radius: 3px;
      color: var(--accent-blue);
    }

    pre {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 6px;
      padding: 1.5rem;
      overflow-x: auto;
      margin-bottom: 1.5rem;
    }

    pre code {
      background: none;
      padding: 0;
    }

    /* Lists */
    ul, ol {
      margin-left: 2rem;
      margin-bottom: 1.5rem;
    }

    li {
      margin-bottom: 0.5rem;
    }

    /* Images */
    img {
      max-width: 100%;
      height: auto;
      border-radius: 8px;
      margin: 2rem 0;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }

    /* Tables */
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 2rem 0;
      background: var(--bg-secondary);
      border-radius: 8px;
      overflow: hidden;
    }

    th, td {
      padding: 1rem;
      text-align: left;
      border-bottom: 1px solid var(--border-color);
    }

    th {
      background: var(--bg-primary);
      color: var(--accent-blue);
      font-family: var(--font-secondary);
      font-weight: 700;
    }

    /* Glossary Terms */
    .glossary-term {
      color: var(--accent-blue);
      text-decoration: underline dotted 1px var(--accent-blue);
      cursor: help;
      position: relative;
      transition: all 0.2s;
    }

    .glossary-term:hover,
    .glossary-term:focus {
      color: var(--accent-orange);
      text-decoration-color: var(--accent-orange);
    }

    /* Tooltip */
    .tooltip {
      position: fixed;
      z-index: 1000;
      background: var(--bg-secondary);
      border: 2px solid var(--accent-blue);
      border-radius: 8px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5);
      max-width: 450px;
      padding: 1.5rem;
      display: none;
      animation: tooltipFadeIn 0.2s ease-out;
    }

    .tooltip.active {
      display: block;
    }

    @keyframes tooltipFadeIn {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .tooltip-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
      padding-bottom: 0.75rem;
      border-bottom: 1px solid var(--border-color);
    }

    .tooltip-term {
      font-family: var(--font-secondary);
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--accent-blue);
    }

    .tooltip-levels {
      display: flex;
      gap: 0.5rem;
    }

    .level-btn {
      padding: 0.375rem 0.75rem;
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      border-radius: 4px;
      color: var(--text-secondary);
      font-family: var(--font-secondary);
      font-size: 0.75rem;
      cursor: pointer;
      transition: all 0.2s;
    }

    .level-btn.active {
      background: var(--accent-blue);
      color: #fff;
      border-color: var(--accent-blue);
    }

    .tooltip-body {
      color: var(--text-primary);
    }

    .tooltip-definition {
      font-size: 1rem;
      line-height: 1.6;
      margin-bottom: 1rem;
    }

    .tooltip-example {
      background: var(--bg-primary);
      border-left: 3px solid var(--accent-orange);
      padding: 0.75rem 1rem;
      font-size: 0.9rem;
      margin-bottom: 1rem;
      border-radius: 4px;
    }

    .tooltip-related {
      font-size: 0.85rem;
      color: var(--text-secondary);
    }

    .tooltip-related a {
      color: var(--accent-blue);
      text-decoration: none;
      margin: 0 0.5rem;
    }

    .tooltip-related a:hover {
      text-decoration: underline;
    }

    /* Complexity Controls */
    .complexity-controls {
      position: sticky;
      top: 0;
      background: var(--bg-primary);
      border-bottom: 2px solid var(--border-color);
      padding: 1.5rem 0;
      margin-bottom: 2rem;
      z-index: 100;
    }

    .complexity-label {
      font-family: var(--font-secondary);
      font-size: 0.95rem;
      font-weight: 600;
      color: var(--text-secondary);
      margin-bottom: 0.75rem;
      display: block;
    }

    .complexity-buttons {
      display: flex;
      gap: 0.75rem;
      flex-wrap: wrap;
    }

    .complexity-btn {
      padding: 0.75rem 1.5rem;
      background: var(--bg-secondary);
      border: 2px solid var(--border-color);
      border-radius: 6px;
      color: var(--text-primary);
      font-family: var(--font-secondary);
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }

    .complexity-btn.active {
      background: var(--accent-blue);
      color: #fff;
      border-color: var(--accent-blue);
    }

    .complexity-btn:hover:not(.active) {
      background: var(--bg-primary);
      border-color: var(--accent-blue);
    }

    .content-section {
      transition: opacity 0.3s, transform 0.3s;
    }

    .content-section.hidden {
      display: none;
    }

    /* TTS Player Widget */
    .tts-player {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 320px;
      background: var(--bg-secondary);
      border: 2px solid var(--accent-blue);
      border-radius: 12px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
      z-index: 999;
      overflow: hidden;
    }

    .tts-player-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 1.25rem;
      background: var(--bg-primary);
      border-bottom: 1px solid var(--border-color);
      cursor: pointer;
    }

    .tts-player-title {
      font-family: var(--font-secondary);
      font-size: 1rem;
      font-weight: 700;
      color: var(--accent-blue);
    }

    .tts-player-toggle {
      background: none;
      border: none;
      color: var(--text-primary);
      font-size: 1.25rem;
      cursor: pointer;
      transition: transform 0.3s;
    }

    .tts-player-toggle.collapsed {
      transform: rotate(-90deg);
    }

    .tts-player-content {
      padding: 1.25rem;
      max-height: 400px;
      overflow-y: auto;
    }

    .tts-player-content.collapsed {
      display: none;
    }

    .tts-controls {
      display: flex;
      gap: 0.75rem;
      margin-bottom: 1rem;
    }

    .tts-btn {
      flex: 1;
      padding: 0.75rem;
      background: var(--accent-blue);
      border: none;
      border-radius: 6px;
      color: #fff;
      font-size: 1.25rem;
      cursor: pointer;
      transition: all 0.2s;
    }

    .tts-btn:hover:not(:disabled) {
      background: var(--accent-orange);
      transform: scale(1.05);
    }

    .tts-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .tts-progress {
      margin-bottom: 1rem;
    }

    .tts-progress-bar-container {
      width: 100%;
      height: 8px;
      background: var(--bg-primary);
      border-radius: 4px;
      overflow: hidden;
      margin-bottom: 0.5rem;
    }

    .tts-progress-bar {
      height: 100%;
      background: var(--accent-blue);
      width: 0%;
      transition: width 0.3s;
    }

    .tts-progress-text {
      font-family: var(--font-secondary);
      font-size: 0.85rem;
      color: var(--text-secondary);
      text-align: center;
      display: block;
    }

    .tts-speed {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 1rem;
    }

    .tts-speed label {
      font-family: var(--font-secondary);
      font-size: 0.9rem;
      color: var(--text-secondary);
    }

    .tts-speed input {
      flex: 1;
    }

    .tts-speed-value {
      font-family: var(--font-mono);
      font-size: 0.9rem;
      color: var(--accent-blue);
      min-width: 3rem;
      text-align: right;
    }

    .tts-status {
      font-family: var(--font-secondary);
      font-size: 0.85rem;
      color: var(--text-secondary);
      text-align: center;
      padding: 0.5rem;
      background: var(--bg-primary);
      border-radius: 4px;
    }

    /* Animations */
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .fade-in {
      animation: fadeIn 0.6s ease-out;
    }

    /* Responsive */
    @media (max-width: 1024px) {
      .glossary-sidebar {
        position: fixed;
        left: -300px;
        transition: left 0.3s;
        z-index: 998;
      }

      .glossary-sidebar.open {
        left: 0;
      }

      .content-area {
        max-width: 100%;
      }

      .tts-player {
        width: 280px;
      }
    }

    @media (max-width: 640px) {
      .content-area {
        padding: 2rem 1rem;
      }

      h1 {
        font-size: 2rem;
      }

      .tts-player {
        width: calc(100% - 40px);
        bottom: 10px;
        right: 10px;
      }

      .complexity-buttons {
        flex-direction: column;
      }

      .complexity-btn {
        width: 100%;
      }
    }

    /* Accessibility */
    :focus {
      outline: 2px solid var(--accent-blue);
      outline-offset: 2px;
    }

    @media (prefers-reduced-motion: reduce) {
      *,
      *::before,
      *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }

    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border-width: 0;
    }
  </style>
</head>
<body>
  <div class="educational-container">
    <!-- Glossary Sidebar -->
    <aside class="glossary-sidebar" role="complementary" aria-label="Glossary navigation">
      <div class="sidebar-header">
        <h2 class="sidebar-title">Glossary</h2>
        <input type="search" class="glossary-search" placeholder="Search terms..." aria-label="Search glossary terms">
      </div>

      <div class="glossary-filters">
        <button class="filter-btn active" data-importance="all">All</button>
        <button class="filter-btn" data-importance="critical">Critical</button>
        <button class="filter-btn" data-importance="important">Important</button>
      </div>

      <ul class="glossary-list" role="list">
        <!-- Dynamically populated -->
      </ul>
    </aside>

    <!-- Main Content -->
    <main class="content-area">
      <!-- Complexity Controls -->
      <div class="complexity-controls">
        <label class="complexity-label">Show complexity level:</label>
        <div class="complexity-buttons">
          <button class="complexity-btn active" data-level="all">All Levels</button>
          <button class="complexity-btn" data-level="beginner">Beginner</button>
          <button class="complexity-btn" data-level="intermediate">Intermediate</button>
          <button class="complexity-btn" data-level="expert">Expert</button>
        </div>
      </div>

      <article class="fade-in">
        <h1>The Quantum World: Atoms and Subatomic Particles</h1>

        <section class="content-section" data-complexity="beginner">
          <h2>Introduction</h2>
          <p><span class="glossary-term" data-term="atom">Atoms</span> are the fundamental building blocks of matter, yet they consist of even smaller <span class="glossary-term" data-term="subatomic-particle">subatomic particles</span> governed by the laws of <span class="glossary-term" data-term="quantum-mechanics">quantum mechanics</span>. This visualization explores the hierarchical structure of matter from atoms down to <span class="glossary-term" data-term="quark">quarks</span>, revealing the elegant complexity of the physical universe.</p>
        </section>

        <section class="content-section" data-complexity="beginner">
          <h2>Part 1: The Atom - Building Block of Matter</h2>
          <img src="https://replicate.delivery/czjl/p22bFu2BWloTNZF7jjq54hUlEpbwELBer6zMu842kpS9630KA/out-0.webp" alt="Complete atom structure showing nucleus and electron shells" loading="lazy">

          <p>An <span class="glossary-term" data-term="atom">atom</span> consists of a dense central <span class="glossary-term" data-term="nucleus">nucleus</span> surrounded by a cloud of <span class="glossary-term" data-term="electron">electrons</span> arranged in discrete energy levels called <span class="glossary-term" data-term="electron-shell">electron shells</span>. Despite being the smallest unit of a chemical element that retains its properties, atoms are mostly empty space - if an atom were the size of a football stadium, the nucleus would be the size of a pea at the center.</p>

          <h3>Atomic Structure</h3>
          <p>The atom comprises three fundamental components:</p>
          <ol>
            <li><strong>Nucleus</strong> - The dense core containing 99.9% of the atom's mass</li>
            <li><strong>Electron shells</strong> - Quantized energy levels where electrons reside</li>
            <li><strong>Empty space</strong> - The vast majority of atomic volume</li>
          </ol>

          <h3>Key Properties</h3>
          <ul>
            <li><strong><span class="glossary-term" data-term="atomic-number">Atomic number (Z)</span></strong>: Number of protons, defines the element</li>
            <li><strong><span class="glossary-term" data-term="mass-number">Mass number (A)</span></strong>: Total protons plus neutrons</li>
            <li><strong>Atomic mass</strong>: Measured in <span class="glossary-term" data-term="amu">atomic mass units (amu)</span>, approximately the mass number</li>
            <li><strong>Electrical neutrality</strong>: In neutral atoms, electrons equal protons</li>
          </ul>
        </section>

        <section class="content-section" data-complexity="intermediate">
          <h2>Part 2: Subatomic Particles - The Trinity of Matter</h2>
          <img src="https://replicate.delivery/czjl/txue06SATfhvqk8fkxeAXXQ8j6UqYHYTuaeg1AcymlsjvebaF/out-0.webp" alt="Comparison of subatomic particles: protons, neutrons, and electrons" loading="lazy">

          <p>Three fundamental <span class="glossary-term" data-term="subatomic-particle">subatomic particles</span> constitute all ordinary matter. Each possesses unique properties that determine atomic behavior and chemical interactions.</p>

          <h3>Protons: The Identity Determiners</h3>
          <ul>
            <li><strong>Location</strong>: <span class="glossary-term" data-term="nucleus">Nucleus</span></li>
            <li><strong>Charge</strong>: +1 <span class="glossary-term" data-term="elementary-charge">elementary charge</span> (+1.602 √ó 10‚Åª¬π‚Åπ coulombs)</li>
            <li><strong>Mass</strong>: 1.6726 √ó 10‚Åª¬≤‚Å∑ kg (1.007 amu)</li>
            <li><strong>Composition</strong>: 2 <span class="glossary-term" data-term="up-quark">up quarks</span>, 1 <span class="glossary-term" data-term="down-quark">down quark</span> (uud)</li>
          </ul>
          <p><span class="glossary-term" data-term="proton">Protons</span> define an element's identity. Change the proton count, and you change the element itself. The <span class="glossary-term" data-term="strong-force">strong nuclear force</span> binds protons together in the nucleus despite electromagnetic repulsion between positive charges.</p>

          <h3>Neutrons: The Stabilizers</h3>
          <ul>
            <li><strong>Location</strong>: Nucleus</li>
            <li><strong>Charge</strong>: 0 (electrically neutral)</li>
            <li><strong>Mass</strong>: 1.6749 √ó 10‚Åª¬≤‚Å∑ kg (1.009 amu)</li>
            <li><strong>Composition</strong>: 1 up quark, 2 down quarks (udd)</li>
          </ul>
          <p><span class="glossary-term" data-term="neutron">Neutrons</span> stabilize atomic nuclei by adding strong nuclear force attraction without electromagnetic repulsion. <span class="glossary-term" data-term="isotope">Isotopes</span> of an element differ only in neutron count. Free neutrons are unstable, undergoing <span class="glossary-term" data-term="beta-decay">beta decay</span> with a half-life of approximately 10 minutes.</p>

          <h3>Electrons: The Chemistry Drivers</h3>
          <ul>
            <li><strong>Location</strong>: <span class="glossary-term" data-term="orbital">Electron shells/orbitals</span></li>
            <li><strong>Charge</strong>: -1 elementary charge (-1.602 √ó 10‚Åª¬π‚Åπ coulombs)</li>
            <li><strong>Mass</strong>: 9.1094 √ó 10‚Åª¬≥¬π kg (0.00055 amu)</li>
            <li><strong>Composition</strong>: <span class="glossary-term" data-term="elementary-particle">Elementary particle</span> (no internal structure)</li>
          </ul>
          <p><span class="glossary-term" data-term="electron">Electrons</span> are fundamental <span class="glossary-term" data-term="lepton">leptons</span> with no known substructure. Their arrangement in atomic orbitals determines all chemical bonding and reactions. The electron's mass is approximately 1/1836 that of a proton, yet it carries equal and opposite charge.</p>
        </section>

        <section class="content-section" data-complexity="expert">
          <h2>Part 3: Quarks - The Ultimate Constituents</h2>
          <img src="https://replicate.delivery/czjl/0qLoTTiPIb6oGhk2nrBgBZ2uoCUq5afZehSWhcLl5MrerfmWB/out-0.webp" alt="Quarks inside a proton showing color charges" loading="lazy">

          <p><span class="glossary-term" data-term="quark">Quarks</span> represent the deepest known layer of matter structure. These fundamental particles cannot exist in isolation due to a phenomenon called <span class="glossary-term" data-term="color-confinement">color confinement</span> - they are perpetually bound within composite particles called <span class="glossary-term" data-term="hadron">hadrons</span>.</p>

          <h3>Quark Flavors in Ordinary Matter</h3>
          <h4>Up Quark (u)</h4>
          <ul>
            <li>Charge: +2/3 elementary charge</li>
            <li>Mass: ~2.2 MeV/c¬≤ (‚âà 4 √ó 10‚Åª¬≥‚Å∞ kg)</li>
            <li><span class="glossary-term" data-term="color-charge">Color charge</span>: Red, green, or blue (quantum property)</li>
          </ul>

          <h4>Down Quark (d)</h4>
          <ul>
            <li>Charge: -1/3 elementary charge</li>
            <li>Mass: ~4.7 MeV/c¬≤ (‚âà 8 √ó 10‚Åª¬≥‚Å∞ kg)</li>
            <li>Color charge: Red, green, or blue</li>
          </ul>

          <h3>Quark Composition of Nucleons</h3>
          <p><strong>Proton (uud)</strong>:</p>
          <ul>
            <li>2 up quarks: 2 √ó (+2/3) = +4/3</li>
            <li>1 down quark: 1 √ó (-1/3) = -1/3</li>
            <li><strong>Total charge</strong>: +4/3 - 1/3 = +1 ‚úì</li>
          </ul>

          <p><strong>Neutron (udd)</strong>:</p>
          <ul>
            <li>1 up quark: 1 √ó (+2/3) = +2/3</li>
            <li>2 down quarks: 2 √ó (-1/3) = -2/3</li>
            <li><strong>Total charge</strong>: +2/3 - 2/3 = 0 ‚úì</li>
          </ul>

          <h3>Quantum Chromodynamics (QCD)</h3>
          <p>Quarks interact via the <span class="glossary-term" data-term="strong-force">strong force</span>, mediated by particles called <span class="glossary-term" data-term="gluon">gluons</span>. This interaction involves a property called "color charge" (unrelated to visible color):</p>
          <ul>
            <li><strong>Color confinement</strong>: Quarks cannot be isolated; they form color-neutral combinations</li>
            <li><strong>Gluons</strong>: Massless force carriers that also carry color charge (unique among force carriers)</li>
            <li><strong><span class="glossary-term" data-term="asymptotic-freedom">Asymptotic freedom</span></strong>: Quarks interact more weakly at short distances (Nobel Prize 2004)</li>
          </ul>

          <h3>The Quark-Gluon Sea</h3>
          <p>Modern <span class="glossary-term" data-term="quantum-field-theory">quantum field theory</span> reveals that protons and neutrons contain more than just three "valence" quarks:</p>
          <ul>
            <li><strong>Valence quarks</strong>: The three quarks (uud or udd) that give the particle its identity</li>
            <li><strong>Sea quarks</strong>: Virtual quark-antiquark pairs constantly appearing and vanishing</li>
            <li><strong>Gluons</strong>: Constantly exchanged between quarks, carrying ~50% of <span class="glossary-term" data-term="nucleon">nucleon</span> momentum</li>
          </ul>
          <p>The mass of a proton is NOT simply the sum of its three valence quarks. Quark masses sum to ~10 MeV/c¬≤, but the proton mass is 938 MeV/c¬≤. The additional mass comes from the kinetic energy of quarks and gluons confined within - a direct manifestation of Einstein's E=mc¬≤.</p>
        </section>

        <section class="content-section" data-complexity="expert">
          <h2>Part 4: Electron Orbitals - Quantum Probability Clouds</h2>
          <img src="https://replicate.delivery/czjl/vVsdfRBbZnW5BC4q8pleiHS8OQefFIMvWISe7KP1nGtFwebaF/out-0.webp" alt="Quantum mechanical electron orbitals showing s, p, d orbital shapes" loading="lazy">

          <p>The early planetary model of electrons orbiting like planets is fundamentally incorrect. <span class="glossary-term" data-term="quantum-mechanics">Quantum mechanics</span> reveals that electrons exist in probabilistic <span class="glossary-term" data-term="wavefunction">wavefunctions</span> called <span class="glossary-term" data-term="orbital">orbitals</span> - three-dimensional regions where electrons are likely to be found.</p>

          <h3>The Quantum Mechanical Model</h3>
          <p><strong><span class="glossary-term" data-term="wave-particle-duality">Wave-Particle Duality</span></strong>: Electrons simultaneously exhibit wave and particle properties, described by the <span class="glossary-term" data-term="schrodinger-equation">Schr√∂dinger equation</span>:</p>
          <pre><code>ƒ§œà = Eœà</code></pre>
          <p>Where:</p>
          <ul>
            <li><strong>ƒ§</strong>: Hamiltonian operator (total energy)</li>
            <li><strong>œà</strong> (psi): Wavefunction (describes electron probability amplitude)</li>
            <li><strong>E</strong>: Energy eigenvalue (allowed energy levels)</li>
          </ul>

          <h3>Quantum Numbers</h3>
          <p>Four <span class="glossary-term" data-term="quantum-number">quantum numbers</span> completely specify an electron's state:</p>
          <ol>
            <li><strong>Principal quantum number (n)</strong>: Energy level (1, 2, 3, ...)</li>
            <li><strong>Angular momentum quantum number (‚Ñì)</strong>: Orbital shape (0 to n-1)</li>
            <li><strong>Magnetic quantum number (m‚Ñì)</strong>: Orbital orientation (-‚Ñì to +‚Ñì)</li>
            <li><strong>Spin quantum number (ms)</strong>: Electron spin (+¬Ω or -¬Ω)</li>
          </ol>

          <h3>The Heisenberg Uncertainty Principle</h3>
          <p>We cannot simultaneously know both an electron's exact position and momentum:</p>
          <pre><code>Œîx ¬∑ Œîp ‚â• ‚Ñè/2</code></pre>
          <p>This is not a measurement limitation but a fundamental property of nature. Orbitals represent probability distributions because precise electron "orbits" cannot exist.</p>
        </section>

        <section class="content-section" data-complexity="intermediate">
          <h2>Scales and Magnitudes</h2>
          <p>Understanding atomic and subatomic scales requires perspective:</p>
          <table>
            <thead>
              <tr>
                <th>Object</th>
                <th>Approximate Size</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Atom</td>
                <td>10‚Åª¬π‚Å∞ m (1 √Öngstr√∂m)</td>
              </tr>
              <tr>
                <td>Nucleus</td>
                <td>10‚Åª¬π‚Åµ m (1 femtometer)</td>
              </tr>
              <tr>
                <td>Proton</td>
                <td>10‚Åª¬π‚Åµ m (0.84 fm radius)</td>
              </tr>
              <tr>
                <td>Quark</td>
                <td>&lt; 10‚Åª¬π‚Å∏ m (possibly point-like)</td>
              </tr>
              <tr>
                <td>Electron</td>
                <td>&lt; 10‚Åª¬≤¬≤ m (possibly point-like)</td>
              </tr>
            </tbody>
          </table>
          <p><strong>Scale Analogy</strong>: If a hydrogen atom were scaled to the size of Earth, the proton would be ~200 meters across, and quarks would still be smaller than atoms at normal scale.</p>
        </section>

        <section class="content-section" data-complexity="beginner">
          <h2>Conclusion</h2>
          <p>The journey from atoms to quarks reveals matter's hierarchical structure:</p>
          <ol>
            <li><strong>Atoms</strong> - The chemical elements (118 known)</li>
            <li><strong>Subatomic particles</strong> - Protons, neutrons, electrons</li>
            <li><strong>Quarks and leptons</strong> - The truly fundamental constituents</li>
            <li><strong>Quantum fields</strong> - The deepest description: particles as excitations in underlying fields</li>
          </ol>
          <p>This structure is governed by four fundamental forces (strong, electromagnetic, weak, gravitational) and described by quantum field theory - humanity's most precisely tested scientific framework. The electron's magnetic moment has been measured to 12 decimal places and matches theoretical predictions perfectly.</p>
        </section>
      </article>
    </main>
  </div>

  <!-- TTS Player Widget -->
  <div class="tts-player" id="ttsPlayer">
    <div class="tts-player-header" id="ttsHeader">
      <span class="tts-player-title">üéß Read Aloud</span>
      <button class="tts-player-toggle" id="ttsToggle" aria-label="Toggle TTS player">‚ñº</button>
    </div>

    <div class="tts-player-content" id="ttsContent">
      <div class="tts-controls">
        <button class="tts-btn" id="ttsPlay" title="Play" aria-label="Play narration">‚ñ∂Ô∏è</button>
        <button class="tts-btn" id="ttsPause" title="Pause" aria-label="Pause narration" style="display:none;">‚è∏Ô∏è</button>
        <button class="tts-btn" id="ttsStop" title="Stop" aria-label="Stop narration">‚èπÔ∏è</button>
      </div>

      <div class="tts-progress">
        <div class="tts-progress-bar-container">
          <div class="tts-progress-bar" id="ttsProgressBar"></div>
        </div>
        <span class="tts-progress-text" id="ttsProgressText">0%</span>
      </div>

      <div class="tts-speed">
        <label for="ttsSpeed">Speed:</label>
        <input type="range" id="ttsSpeed" min="0.5" max="2" step="0.25" value="1" aria-label="Playback speed">
        <span class="tts-speed-value" id="ttsSpeedValue">1x</span>
      </div>

      <div class="tts-status" id="ttsStatus">Ready</div>
    </div>
  </div>

  <!-- Tooltip Container -->
  <div class="tooltip" id="tooltip" role="tooltip" aria-hidden="true">
    <div class="tooltip-header">
      <h4 class="tooltip-term" id="tooltipTerm"></h4>
      <div class="tooltip-levels">
        <button class="level-btn active" data-level="simple">Simple</button>
        <button class="level-btn" data-level="standard">Standard</button>
        <button class="level-btn" data-level="technical">Technical</button>
      </div>
    </div>
    <div class="tooltip-body">
      <p class="tooltip-definition" id="tooltipDefinition"></p>
      <div class="tooltip-example" id="tooltipExample"></div>
      <div class="tooltip-related" id="tooltipRelated"></div>
    </div>
  </div>

  <script>
    // TTS Configuration
    window.TTS_CONFIG = {
      apiKey: '${ELEVENLABS_API_KEY}',
      voiceId: '21m00Tcm4TlvDq8ikWAM',
      theme: 'Academic'
    };

    // Glossary Data (embedded inline for static hosting)
    const GLOSSARY_DATA = [
      {
        term: "atom",
        definitions: {
          simple: "The smallest piece of an element that still acts like that element.",
          standard: "The smallest unit of a chemical element that retains all the properties of that element.",
          technical: "A fundamental unit of matter consisting of a dense nucleus of protons and neutrons surrounded by a cloud of electrons, representing the smallest neutral particle of an element that can participate in chemical reactions."
        },
        example: "A single atom of gold has all the properties that make gold unique, but you can't see it with your eyes.",
        importance: "critical"
      },
      {
        term: "subatomic-particle",
        definitions: {
          simple: "Tiny particles that make up atoms, like building blocks.",
          standard: "Particles smaller than atoms, including protons, neutrons, and electrons.",
          technical: "Particles that constitute the structure of atoms or are produced in nuclear reactions, including fundamental particles (quarks, leptons, bosons) and composite particles (hadrons, nuclei)."
        },
        example: "Protons, neutrons, and electrons are subatomic particles that combine to form atoms.",
        importance: "critical"
      },
      {
        term: "quantum-mechanics",
        definitions: {
          simple: "The rules that describe how very tiny things behave differently from big things.",
          standard: "The branch of physics that describes the behavior of matter and energy at atomic and subatomic scales.",
          technical: "A fundamental theory in physics describing the physical properties of nature at the scale of atoms and subatomic particles, characterized by quantization, wave-particle duality, and the uncertainty principle."
        },
        example: "Quantum mechanics explains why electrons exist in specific energy levels around atoms rather than anywhere in between.",
        importance: "important"
      },
      {
        term: "quark",
        definitions: {
          simple: "Even tinier particles that join together to make protons and neutrons.",
          standard: "Fundamental particles that combine to form protons, neutrons, and other composite particles.",
          technical: "Elementary fermions that carry fractional electric charge and interact via the strong force mediated by gluons. Six flavors exist (up, down, charm, strange, top, bottom), with up and down quarks forming ordinary matter."
        },
        example: "A proton contains two up quarks and one down quark held together by the strong force.",
        importance: "important"
      },
      {
        term: "nucleus",
        definitions: {
          simple: "The center of an atom where almost all its weight is located.",
          standard: "The dense central core of an atom containing protons and neutrons.",
          technical: "The positively charged central region of an atom composed of nucleons (protons and neutrons) bound by the strong nuclear force, containing 99.9% of the atomic mass in approximately 1/100,000th of the atomic volume."
        },
        example: "If an atom were the size of a stadium, the nucleus would be like a marble at the center.",
        importance: "critical"
      },
      {
        term: "electron",
        definitions: {
          simple: "Tiny negatively charged particles that orbit around the nucleus.",
          standard: "Fundamental particles with negative electric charge that exist in orbitals around the atomic nucleus.",
          technical: "A fundamental lepton with charge -e, rest mass 9.109 √ó 10‚Åª¬≥¬π kg, spin ¬Ω, governed by the Pauli exclusion principle. Electrons determine chemical properties through their arrangement in atomic orbitals."
        },
        example: "Electrons moving between atoms create electricity in a wire.",
        importance: "critical"
      },
      {
        term: "proton",
        definitions: {
          simple: "Positively charged particles in the nucleus that determine what element an atom is.",
          standard: "Positively charged subatomic particles found in the nucleus, determining the atomic number.",
          technical: "A composite hadron consisting of two up quarks and one down quark (uud) bound by gluons, with charge +e, rest mass 1.673 √ó 10‚Åª¬≤‚Å∑ kg, and spin ¬Ω. The number of protons defines the element's identity."
        },
        example: "Carbon has 6 protons, oxygen has 8 protons - the proton count makes them different elements.",
        importance: "critical"
      },
      {
        term: "neutron",
        definitions: {
          simple: "Particles in the nucleus with no electric charge that help hold the nucleus together.",
          standard: "Electrically neutral subatomic particles in the nucleus that stabilize atoms.",
          technical: "A composite hadron consisting of one up quark and two down quarks (udd) bound by gluons, with zero net charge, rest mass 1.675 √ó 10‚Åª¬≤‚Å∑ kg, and spin ¬Ω. Free neutrons undergo beta decay with half-life ~10 minutes."
        },
        example: "Isotopes of the same element have different numbers of neutrons but the same number of protons.",
        importance: "important"
      },
      {
        term: "electron-shell",
        definitions: {
          simple: "Layers around the nucleus where electrons are found.",
          standard: "Regions at specific distances from the nucleus where electrons orbit with defined energy levels.",
          technical: "Quantized energy levels corresponding to solutions of the Schr√∂dinger equation, characterized by principal quantum number n, where electrons exist with discrete energies. Each shell contains subshells (s, p, d, f orbitals)."
        },
        example: "The first electron shell can hold up to 2 electrons, the second can hold up to 8.",
        importance: "important"
      },
      {
        term: "orbital",
        definitions: {
          simple: "The cloud-like area where you're likely to find an electron.",
          standard: "A mathematical function describing the probability distribution of an electron's location around the nucleus.",
          technical: "A wavefunction solution œà(r,Œ∏,œÜ) to the Schr√∂dinger equation representing the quantum state of an electron, with |œà|¬≤ giving the probability density. Characterized by quantum numbers n, ‚Ñì, and m‚Ñì determining shape and orientation."
        },
        example: "An s orbital is spherical, while p orbitals are dumbbell-shaped.",
        importance: "important"
      },
      {
        term: "atomic-number",
        definitions: {
          simple: "The number of protons in an atom's nucleus.",
          standard: "The number of protons in the nucleus, which defines the element's identity (Z).",
          technical: "The number of protons in a nucleus, denoted Z, determining the element's position in the periodic table and its chemical properties. For a neutral atom, Z equals the number of electrons."
        },
        example: "Hydrogen has atomic number 1, helium has atomic number 2.",
        importance: "important"
      },
      {
        term: "mass-number",
        definitions: {
          simple: "The total number of protons plus neutrons in an atom.",
          standard: "The sum of protons and neutrons in the nucleus (A = Z + N).",
          technical: "The total number of nucleons (protons plus neutrons) in a nucleus, denoted A. Different mass numbers with the same atomic number Z represent isotopes of the same element."
        },
        example: "Carbon-12 has mass number 12 (6 protons + 6 neutrons).",
        importance: "important"
      },
      {
        term: "isotope",
        definitions: {
          simple: "Different versions of the same element with different numbers of neutrons.",
          standard: "Atoms of the same element with the same number of protons but different numbers of neutrons.",
          technical: "Nuclides with identical atomic number Z but different mass number A, differing only in neutron count. Isotopes exhibit identical chemical properties but different nuclear properties and stability."
        },
        example: "Carbon-12 and Carbon-14 are isotopes - both have 6 protons but different neutrons.",
        importance: "important"
      },
      {
        term: "strong-force",
        definitions: {
          simple: "The powerful force that holds the nucleus together.",
          standard: "The fundamental force that binds quarks into protons and neutrons, and binds nucleons in the nucleus.",
          technical: "The fundamental interaction mediated by gluons that binds quarks via color charge, exhibiting color confinement and asymptotic freedom. The residual strong force (nuclear force) binds nucleons in nuclei."
        },
        example: "The strong force overcomes the electrical repulsion between positively charged protons in the nucleus.",
        importance: "important"
      },
      {
        term: "elementary-charge",
        definitions: {
          simple: "The basic amount of electric charge, carried by one proton or electron.",
          standard: "The fundamental unit of electric charge, approximately 1.602 √ó 10‚Åª¬π‚Åπ coulombs.",
          technical: "The magnitude of electric charge carried by a single proton (positive) or electron (negative), denoted e = 1.602176634 √ó 10‚Åª¬π‚Åπ C, representing the smallest observed free charge in nature."
        },
        example: "An electron has charge -e and a proton has charge +e.",
        importance: "important"
      },
      {
        term: "lepton",
        definitions: {
          simple: "A family of fundamental particles that includes electrons.",
          standard: "Fundamental particles that do not experience the strong force, including electrons, muons, taus, and neutrinos.",
          technical: "Elementary fermions with spin ¬Ω that interact via electroweak force but not the strong force. Six leptons exist in three generations: electron, muon, tau, and their associated neutrinos."
        },
        example: "Electrons are the most common leptons in everyday matter.",
        importance: "important"
      },
      {
        term: "up-quark",
        definitions: {
          simple: "One type of quark with a positive charge that helps make protons.",
          standard: "A fundamental quark with charge +2/3e, one of the two quarks in ordinary matter.",
          technical: "A first-generation quark with charge +2/3e and mass ~2.2 MeV/c¬≤, carrying color charge. Two up quarks combine with one down quark to form protons (uud)."
        },
        example: "A proton contains two up quarks and one down quark.",
        importance: "important"
      },
      {
        term: "down-quark",
        definitions: {
          simple: "One type of quark with a small negative charge that helps make neutrons.",
          standard: "A fundamental quark with charge -1/3e, one of the two quarks in ordinary matter.",
          technical: "A first-generation quark with charge -1/3e and mass ~4.7 MeV/c¬≤, carrying color charge. Two down quarks combine with one up quark to form neutrons (udd)."
        },
        example: "A neutron contains one up quark and two down quarks.",
        importance: "important"
      },
      {
        term: "color-charge",
        definitions: {
          simple: "A property of quarks (not related to actual colors) that determines how they stick together.",
          standard: "The charge associated with the strong force, coming in three types: red, green, and blue.",
          technical: "The conserved quantum number associated with the SU(3) gauge symmetry of quantum chromodynamics, existing in three varieties (red, green, blue) and three anticolors. Gluons carry combinations of color-anticolor charges."
        },
        example: "Just like positive and negative electric charges attract, different color charges attract quarks together.",
        importance: "important"
      },
      {
        term: "gluon",
        definitions: {
          simple: "Particles that act like glue to hold quarks together.",
          standard: "Force-carrying particles that mediate the strong force between quarks.",
          technical: "Massless gauge bosons (spin 1) that mediate the strong interaction between quarks via exchange of color charge. Eight independent gluon types exist, unique among force carriers in carrying the charge they mediate."
        },
        example: "Gluons constantly zip between quarks, holding them together inside protons and neutrons.",
        importance: "important"
      },
      {
        term: "hadron",
        definitions: {
          simple: "Particles made up of quarks, like protons and neutrons.",
          standard: "Composite particles made of quarks bound by the strong force.",
          technical: "Composite particles consisting of quarks bound by gluons via the strong interaction. Classified as baryons (three quarks) or mesons (quark-antiquark pairs). Examples include protons, neutrons, pions, and kaons."
        },
        example: "Protons and neutrons are hadrons because they're made of quarks.",
        importance: "important"
      },
      {
        term: "color-confinement",
        definitions: {
          simple: "The rule that quarks can never be found alone - they're always stuck together.",
          standard: "The phenomenon where quarks cannot exist as isolated particles and are permanently confined within hadrons.",
          technical: "A consequence of quantum chromodynamics where the potential energy between quarks increases with distance, preventing isolation of individual quarks. Attempting to separate quarks creates new quark-antiquark pairs from the vacuum energy."
        },
        example: "If you try to pull quarks apart, the energy creates new quarks instead of separating them.",
        importance: "important"
      },
      {
        term: "wavefunction",
        definitions: {
          simple: "A mathematical description of where a particle might be and how it behaves.",
          standard: "A mathematical function that describes the quantum state of a particle.",
          technical: "A complex-valued function œà(r,t) that contains all information about a quantum system. The square of its absolute value |œà|¬≤ gives the probability density for finding the particle at position r at time t."
        },
        example: "The wavefunction of an electron tells us the probability of finding it at different locations around a nucleus.",
        importance: "important"
      },
      {
        term: "wave-particle-duality",
        definitions: {
          simple: "The strange fact that tiny particles can act like both particles and waves.",
          standard: "The quantum mechanical principle that matter exhibits both wave and particle properties.",
          technical: "A fundamental concept in quantum mechanics stating that all matter and radiation exhibit both wave and particle characteristics, demonstrated by phenomena like electron diffraction and the photoelectric effect."
        },
        example: "Electrons create interference patterns like waves but also hit detectors at specific points like particles.",
        importance: "important"
      },
      {
        term: "schrodinger-equation",
        definitions: {
          simple: "The main equation that describes how quantum particles behave.",
          standard: "The fundamental equation of quantum mechanics that describes how quantum states evolve over time.",
          technical: "A linear partial differential equation ƒ§œà = Eœà (time-independent form) or i‚Ñè‚àÇœà/‚àÇt = ƒ§œà (time-dependent form) that governs the evolution of wavefunctions in quantum systems."
        },
        example: "Solving the Schr√∂dinger equation for an atom reveals the allowed electron energy levels.",
        importance: "important"
      },
      {
        term: "quantum-number",
        definitions: {
          simple: "Numbers that describe an electron's properties in an atom.",
          standard: "Discrete values that specify the quantum state of an electron in an atom.",
          technical: "Quantized values (n, ‚Ñì, m‚Ñì, ms) that emerge as eigenvalues from solutions to the Schr√∂dinger equation, completely specifying an electron's state in accordance with the Pauli exclusion principle."
        },
        example: "The four quantum numbers (n, ‚Ñì, m‚Ñì, ms) uniquely identify each electron in an atom.",
        importance: "important"
      },
      {
        term: "nucleon",
        definitions: {
          simple: "A particle in the nucleus - either a proton or neutron.",
          standard: "Collective term for protons and neutrons, the constituents of atomic nuclei.",
          technical: "Either a proton or neutron, composite baryons consisting of three quarks bound by the strong force. The term emphasizes their role as nuclear building blocks."
        },
        example: "A carbon-12 nucleus contains 12 nucleons: 6 protons and 6 neutrons.",
        importance: "important"
      },
      {
        term: "beta-decay",
        definitions: {
          simple: "A process where a neutron changes into a proton (or vice versa) by emitting particles.",
          standard: "A type of radioactive decay where a neutron converts to a proton or vice versa, emitting an electron or positron.",
          technical: "A weak interaction process where a neutron transforms into a proton, electron, and electron antineutrino (Œ≤‚Åª decay) or a proton transforms into a neutron, positron, and electron neutrino (Œ≤‚Å∫ decay)."
        },
        example: "Free neutrons undergo beta decay with a half-life of about 10 minutes.",
        importance: "important"
      },
      {
        term: "asymptotic-freedom",
        definitions: {
          simple: "The strange property that quarks interact more weakly when they're very close together.",
          standard: "The property of quantum chromodynamics where the strong force becomes weaker at short distances.",
          technical: "A fundamental property of QCD where the coupling constant decreases at high energies (short distances), allowing perturbative calculations. This phenomenon earned Gross, Politzer, and Wilczek the 2004 Nobel Prize."
        },
        example: "Quarks inside a proton act almost independently at very short distances due to asymptotic freedom.",
        importance: "important"
      },
      {
        term: "quantum-field-theory",
        definitions: {
          simple: "The advanced theory that describes particles as ripples in invisible fields.",
          standard: "A theoretical framework combining quantum mechanics and special relativity to describe particle physics.",
          technical: "A fundamental framework treating particles as quantized excitations of underlying fields, incorporating special relativity and quantum mechanics. The Standard Model is formulated as a quantum field theory."
        },
        example: "In quantum field theory, an electron is a localized excitation in the electron field that fills all of space.",
        importance: "important"
      },
      {
        term: "amu",
        definitions: {
          simple: "A unit for measuring the tiny mass of atoms.",
          standard: "Atomic mass unit, approximately the mass of one proton or neutron.",
          technical: "A standard unit of mass equal to 1/12 the mass of a carbon-12 atom, equivalent to 1.66054 √ó 10‚Åª¬≤‚Å∑ kg. Used to express atomic and molecular masses."
        },
        example: "A proton has a mass of about 1 amu, while an electron is about 0.0005 amu.",
        importance: "important"
      },
      {
        term: "elementary-particle",
        definitions: {
          simple: "A particle with no smaller parts inside it.",
          standard: "Fundamental particles with no known internal structure or subcomponents.",
          technical: "Particles with no measurable internal structure, considered point-like within current experimental resolution. Includes quarks, leptons, and gauge bosons of the Standard Model."
        },
        example: "Electrons are elementary particles, but protons are not (they contain quarks).",
        importance: "important"
      }
    ];

    // Glossary System
    (function initGlossary() {
      const glossaryList = document.querySelector('.glossary-list');
      const searchInput = document.querySelector('.glossary-search');
      const filterBtns = document.querySelectorAll('.filter-btn');
      const tooltip = document.getElementById('tooltip');
      let currentFilter = 'all';
      let currentLevel = 'simple';

      // Populate glossary sidebar
      function renderGlossary(filter = 'all', searchTerm = '') {
        const filtered = GLOSSARY_DATA.filter(entry => {
          const matchesFilter = filter === 'all' || entry.importance === filter;
          const matchesSearch = entry.term.toLowerCase().includes(searchTerm.toLowerCase());
          return matchesFilter && matchesSearch;
        });

        glossaryList.innerHTML = filtered
          .sort((a, b) => a.term.localeCompare(b.term))
          .map(entry => `
            <li class="glossary-item" data-term="${entry.term}" data-importance="${entry.importance}">
              <button class="glossary-link" data-term="${entry.term}">
                ${entry.term.replace(/-/g, ' ')}
                ${entry.importance === 'critical' ? '<span class="importance-badge">Key</span>' : ''}
              </button>
            </li>
          `).join('');

        // Add click handlers
        document.querySelectorAll('.glossary-link').forEach(link => {
          link.addEventListener('click', (e) => {
            const term = e.currentTarget.dataset.term;
            const termElement = document.querySelector(`.glossary-term[data-term="${term}"]`);
            if (termElement) {
              termElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
              termElement.focus();
              showTooltip({ target: termElement });
            }
          });
        });
      }

      // Search functionality
      searchInput.addEventListener('input', (e) => {
        renderGlossary(currentFilter, e.target.value);
      });

      // Filter functionality
      filterBtns.forEach(btn => {
        btn.addEventListener('click', (e) => {
          filterBtns.forEach(b => b.classList.remove('active'));
          e.target.classList.add('active');
          currentFilter = e.target.dataset.importance;
          renderGlossary(currentFilter, searchInput.value);
        });
      });

      // Tooltip functionality
      function showTooltip(e) {
        const term = e.target.dataset.term;
        const entry = GLOSSARY_DATA.find(item => item.term === term);
        if (!entry) return;

        document.getElementById('tooltipTerm').textContent = term.replace(/-/g, ' ');
        document.getElementById('tooltipDefinition').textContent = entry.definitions[currentLevel];
        document.getElementById('tooltipExample').textContent = entry.example || '';

        tooltip.classList.add('active');
        positionTooltip(e.target);
      }

      function hideTooltip() {
        tooltip.classList.remove('active');
      }

      function positionTooltip(element) {
        const rect = element.getBoundingClientRect();
        const tooltipRect = tooltip.getBoundingClientRect();

        let top = rect.bottom + window.scrollY + 10;
        let left = rect.left + window.scrollX;

        // Adjust if tooltip goes off-screen
        if (left + tooltipRect.width > window.innerWidth) {
          left = window.innerWidth - tooltipRect.width - 20;
        }

        if (top + tooltipRect.height > window.innerHeight + window.scrollY) {
          top = rect.top + window.scrollY - tooltipRect.height - 10;
        }

        tooltip.style.top = `${top}px`;
        tooltip.style.left = `${left}px`;
      }

      // Tooltip level switching
      document.querySelectorAll('.level-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
          document.querySelectorAll('.level-btn').forEach(b => b.classList.remove('active'));
          e.target.classList.add('active');
          currentLevel = e.target.dataset.level;

          // Update definition
          const term = document.getElementById('tooltipTerm').textContent.replace(/ /g, '-');
          const entry = GLOSSARY_DATA.find(item => item.term === term);
          if (entry) {
            document.getElementById('tooltipDefinition').textContent = entry.definitions[currentLevel];
          }
        });
      });

      // Attach tooltip to glossary terms
      document.querySelectorAll('.glossary-term').forEach(term => {
        term.addEventListener('mouseenter', showTooltip);
        term.addEventListener('focus', showTooltip);
        term.addEventListener('mouseleave', hideTooltip);
        term.addEventListener('blur', hideTooltip);
        term.setAttribute('tabindex', '0');
      });

      // Close tooltip on click outside
      document.addEventListener('click', (e) => {
        if (!e.target.closest('.glossary-term') && !e.target.closest('.tooltip')) {
          hideTooltip();
        }
      });

      // Initial render
      renderGlossary();
    })();

    // Complexity Toggle System
    (function initComplexityToggle() {
      const complexityBtns = document.querySelectorAll('.complexity-btn');
      const sections = document.querySelectorAll('.content-section');

      complexityBtns.forEach(btn => {
        btn.addEventListener('click', (e) => {
          complexityBtns.forEach(b => b.classList.remove('active'));
          e.target.classList.add('active');

          const level = e.target.dataset.level;

          sections.forEach(section => {
            if (level === 'all' || section.dataset.complexity === level) {
              section.classList.remove('hidden');
            } else {
              section.classList.add('hidden');
            }
          });
        });
      });
    })();

    // TTS Player System
    (function initTTS() {
      const ttsHeader = document.getElementById('ttsHeader');
      const ttsToggle = document.getElementById('ttsToggle');
      const ttsContent = document.getElementById('ttsContent');
      const playBtn = document.getElementById('ttsPlay');
      const pauseBtn = document.getElementById('ttsPause');
      const stopBtn = document.getElementById('ttsStop');
      const speedInput = document.getElementById('ttsSpeed');
      const speedValue = document.getElementById('ttsSpeedValue');
      const progressBar = document.getElementById('ttsProgressBar');
      const progressText = document.getElementById('ttsProgressText');
      const statusText = document.getElementById('ttsStatus');

      let isPlaying = false;
      let currentAudio = null;
      let currentChunk = 0;
      let chunks = [];

      // Toggle player
      ttsHeader.addEventListener('click', () => {
        ttsContent.classList.toggle('collapsed');
        ttsToggle.classList.toggle('collapsed');
      });

      // Speed control
      speedInput.addEventListener('input', (e) => {
        const speed = parseFloat(e.target.value);
        speedValue.textContent = `${speed}x`;
        if (currentAudio) {
          currentAudio.playbackRate = speed;
        }
      });

      // Extract text content
      function extractText() {
        const content = document.querySelector('.content-area article');
        const elements = content.querySelectorAll('p, h2, h3, li');
        const text = Array.from(elements)
          .map(el => el.textContent.trim())
          .filter(t => t.length > 0)
          .join('. ');
        return text;
      }

      // Chunk text
      function chunkText(text, maxSize = 5000) {
        const sentences = text.match(/[^.!?]+[.!?]+/g) || [text];
        const result = [];
        let current = '';

        sentences.forEach(sentence => {
          if (current.length + sentence.length > maxSize && current.length > 0) {
            result.push(current.trim());
            current = sentence;
          } else {
            current += ' ' + sentence;
          }
        });

        if (current.trim().length > 0) {
          result.push(current.trim());
        }

        return result;
      }

      // Text to speech
      async function textToSpeech(text) {
        const apiKey = window.TTS_CONFIG.apiKey;
        const voiceId = window.TTS_CONFIG.voiceId;

        if (!apiKey || apiKey.includes('ELEVENLABS_API_KEY')) {
          throw new Error('ElevenLabs API key not configured');
        }

        const response = await fetch(
          `https://api.elevenlabs.io/v1/text-to-speech/${voiceId}/stream`,
          {
            method: 'POST',
            headers: {
              'xi-api-key': apiKey,
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              text: text,
              model_id: 'eleven_turbo_v2_5',
              voice_settings: {
                stability: 0.5,
                similarity_boost: 0.75,
                use_speaker_boost: true
              }
            })
          }
        );

        if (!response.ok) {
          throw new Error(`API error: ${response.status}`);
        }

        return await response.blob();
      }

      // Play audio
      function playAudio(audioBlob) {
        return new Promise((resolve, reject) => {
          const audioUrl = URL.createObjectURL(audioBlob);
          const audio = new Audio(audioUrl);

          audio.playbackRate = parseFloat(speedInput.value);
          audio.addEventListener('ended', () => {
            URL.revokeObjectURL(audioUrl);
            resolve();
          });
          audio.addEventListener('error', reject);

          audio.play();
          currentAudio = audio;
        });
      }

      // Play handler
      playBtn.addEventListener('click', async () => {
        if (chunks.length === 0) {
          statusText.textContent = 'Preparing content...';
          const text = extractText();
          chunks = chunkText(text);
        }

        isPlaying = true;
        playBtn.style.display = 'none';
        pauseBtn.style.display = 'block';
        statusText.textContent = 'Playing...';

        try {
          for (let i = currentChunk; i < chunks.length; i++) {
            if (!isPlaying) break;

            currentChunk = i;
            statusText.textContent = `Playing chunk ${i + 1}/${chunks.length}...`;

            const audioBlob = await textToSpeech(chunks[i]);
            await playAudio(audioBlob);

            const progress = ((i + 1) / chunks.length) * 100;
            progressBar.style.width = `${progress}%`;
            progressText.textContent = `${Math.round(progress)}%`;
          }

          if (isPlaying) {
            statusText.textContent = 'Complete';
            currentChunk = 0;
            isPlaying = false;
            playBtn.style.display = 'block';
            pauseBtn.style.display = 'none';
          }
        } catch (error) {
          statusText.textContent = `Error: ${error.message}`;
          isPlaying = false;
          playBtn.style.display = 'block';
          pauseBtn.style.display = 'none';
        }
      });

      // Pause handler
      pauseBtn.addEventListener('click', () => {
        if (currentAudio) {
          currentAudio.pause();
        }
        isPlaying = false;
        playBtn.style.display = 'block';
        pauseBtn.style.display = 'none';
        statusText.textContent = 'Paused';
      });

      // Stop handler
      stopBtn.addEventListener('click', () => {
        if (currentAudio) {
          currentAudio.pause();
          currentAudio.currentTime = 0;
        }
        isPlaying = false;
        currentChunk = 0;
        playBtn.style.display = 'block';
        pauseBtn.style.display = 'none';
        progressBar.style.width = '0%';
        progressText.textContent = '0%';
        statusText.textContent = 'Stopped';
      });
    })();

    // Keyboard shortcuts
    document.addEventListener('keydown', (e) => {
      // Escape to close tooltip
      if (e.key === 'Escape') {
        document.getElementById('tooltip').classList.remove('active');
      }
    });

    // Mobile sidebar toggle
    if (window.innerWidth <= 1024) {
      const sidebar = document.querySelector('.glossary-sidebar');
      const toggleBtn = document.createElement('button');
      toggleBtn.textContent = 'üìñ Glossary';
      toggleBtn.style.cssText = 'position: fixed; top: 20px; left: 20px; z-index: 999; padding: 0.75rem 1rem; background: var(--accent-blue); color: #fff; border: none; border-radius: 6px; cursor: pointer;';
      document.body.appendChild(toggleBtn);

      toggleBtn.addEventListener('click', () => {
        sidebar.classList.toggle('open');
      });

      // Close sidebar on content click
      document.querySelector('.content-area').addEventListener('click', () => {
        sidebar.classList.remove('open');
      });
    }
  </script>
</body>
</html>